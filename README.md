# Text Neural Network API

Этот проект представляет собой backend API для сервиса, предоставляющего доступ к текстовым нейросетям. API поддерживает работу с несколькими моделями, имеет внутреннюю валюту для учета расхода токенов и систему биллинга.

## Технический стек

- **Node.js**
- **Язык: TypeScript**
- **HTTP библиотека: Express**
- **База данных: PostgreSQL**
- **ORM: TypeORM**
- **Документация API: Swagger**
- **Функциональные требования**

## Функциональные требования

### Аутентификация и авторизация

- Реализовать регистрацию и аутентификацию пользователей.
- Реализовать систему авторизации для доступа к текстовым нейросетям.
- Выбор конкретных технологий и методов для реализации аутентификации и авторизации осуществляется на усмотрение кандидата.

### Поддержка нейросетевых моделей

- Реализовать поддержку нескольких моделей через единый API.
- Создать абстрактный слой для легкого добавления новых моделей.

### Система биллинга

- Реализовать внутреннюю валюту для учета расхода токенов (например: кредиты).
- Рассчитывать стоимость генерации на основе использованных токенов.
- Учитывать, что цена токенов для каждой модели может быть разной (например: dr14: 100 токенов = 20 кредитов, gemini-fash: 100 токенов = 1 кредит).
- Обновлять баланс пользователя после каждой генерации. После генерации баланс пользователя может становиться отрицательным.
- Предотвращать генерацию при недостаточном балансе.
- Реализовать эндпоинт для проверки баланса и обновления баланса пользователя (можно добавить роли пользователей: клиент, админ. Админ может менять баланс).
- Платежную систему подключать не нужно.

### Streaming ответов

- Использовать Server-Sent Events для стриминга ответов от нейросетей.
- Обеспечить корректную обработку прерывания соединения.

### Документация API

- Разработать полную спецификацию Swagger/OpenAPI для всех эндпоинтов API.
- Обеспечить возможность интерактивного тестирования API через Swagger UI.

## Порядок сдачи

Результат выполнения должен быть размещен на GitHub. В репозитории должны быть:

- Исходный код проекта
- README с инструкциями по запуску
- Swagger/OpenAPI спецификация API
- Можно использовать docker/docker compose

## Установка и запуск

### Предварительные требования

- Node.js (v14.x или выше)
- PostgreSQL (v12.x или выше)

### Установка зависимостей

1. Клонируйте репозиторий:

   ```bash
   git clone 
   cd my-api
   ```


2. Установите зависимости:

    ```bash
    npm install
    ```


### Настройка переменных окружения

- Создайте файл `.env` в корне проекта и добавьте следующие переменные:

    ```bash
    DATABASE_URL=postgres://username:password@localhost:5432/mydatabase
    JWT_SECRET=your_jwt_secret
    PORT=3000
    ```
### Запуск приложения

1. Запустите PostgreSQL сервер.

2. Запустите приложение:

    ```bash
    npm run dev
    ```
## Документация API

- Документация API доступна по адресу http://localhost:3000/api-docs после запуска приложения.

- Этот раздел содержит инструкции по установке зависимостей, настройке переменных окружения и запуску приложения.
